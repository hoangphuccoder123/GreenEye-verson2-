<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green ChatBot - T∆∞ v·∫•n r√°c th·∫£i</title>
    <link rel="icon" type="image/png" href="https://cdn.pixabay.com/photo/2013/07/13/14/08/eye-162183_1280.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2E7D32;
            --primary-light: #43A047;
            --primary-dark: #1B5E20;
            --accent-color: #66BB6A;
            --background: linear-gradient(135deg, #E8F5E8 0%, #F1F8E9 50%, #C8E6C9 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #2C3E50;
            --text-light: #546E7A;
            --border-radius: 20px;
            --shadow: 0 8px 32px rgba(46, 125, 50, 0.15);
            --message-user: linear-gradient(135deg, #43A047, #66BB6A);
            --message-bot: linear-gradient(135deg, #F8F9FA, #FFFFFF);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--background);
            min-height: 100vh;
            padding: 1rem;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(102, 187, 106, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(46, 125, 50, 0.08) 0%, transparent 50%);
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            height: calc(100vh - 2rem);
        }

        .sidebar {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            overflow-y: auto;
        }

        .logo-section {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid rgba(102, 187, 106, 0.2);
        }

        .logo {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .logo-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 0.5rem;
        }

        .logo-subtitle {
            font-size: 0.9rem;
            color: var(--text-light);
            line-height: 1.5;
        }

        .features {
            margin-bottom: 2rem;
        }

        .features h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: rgba(102, 187, 106, 0.08);
            border-radius: 12px;
            border-left: 3px solid var(--accent-color);
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            background: rgba(102, 187, 106, 0.15);
            transform: translateX(5px);
        }

        .feature-item i {
            color: var(--primary-color);
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
        }

        .feature-item span {
            font-size: 0.9rem;
            color: var(--text-dark);
            font-weight: 500;
        }

        .quick-actions {
            margin-top: 2rem;
        }

        .quick-btn {
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
        }

        .quick-btn:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--accent-color));
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
        }

        .chat-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            padding: 1.5rem 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }

        .chat-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
        }

        .chat-avatar {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .chat-info {
            position: relative;
            z-index: 1;
        }

        .chat-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.2rem;
        }

        .chat-status {
            font-size: 0.9rem;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .chat-messages {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: 
                radial-gradient(circle at top right, rgba(102, 187, 106, 0.05) 0%, transparent 50%),
                radial-gradient(circle at bottom left, rgba(46, 125, 50, 0.03) 0%, transparent 50%);
        }

        .message {
            margin-bottom: 1.5rem;
            display: flex;
            gap: 1rem;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--message-user);
            color: white;
        }

        .message.bot .message-avatar {
            background: var(--primary-color);
            color: white;
        }

        .message-content {
            max-width: 70%;
            padding: 1.2rem 1.5rem;
            border-radius: 20px;
            position: relative;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: var(--message-user);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message.bot .message-content {
            background: var(--message-bot);
            color: var(--text-dark);
            border: 1px solid rgba(102, 187, 106, 0.2);
            border-bottom-left-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .message-content h4 {
            color: var(--primary-dark);
            font-size: 1.1rem;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .message-content ul {
            margin: 0.8rem 0;
            padding-left: 1.2rem;
        }

        .message-content li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        .message-content strong {
            color: var(--primary-dark);
            font-weight: 600;
        }

        .message-content em {
            color: var(--primary-color);
            font-style: italic;
        }

        .message-content code {
            background: rgba(102, 187, 106, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .message-content h3 {
            color: var(--primary-dark);
            font-size: 1.2rem;
            margin: 1rem 0 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .message-content h4 {
            color: var(--primary-dark);
            font-size: 1.1rem;
            margin: 1rem 0 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 0.5rem;
        }

        .typing-indicator {
            display: none;
            padding: 1rem 1.5rem;
            background: var(--message-bot);
            border-radius: 20px;
            border-bottom-left-radius: 5px;
            border: 1px solid rgba(102, 187, 106, 0.2);
            max-width: 70%;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--primary-color);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .chat-input {
            padding: 1.5rem 2rem;
            background: rgba(255, 255, 255, 0.8);
            border-top: 1px solid rgba(102, 187, 106, 0.2);
        }

        .input-container {
            display: flex;
            gap: 1rem;
            align-items: end;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        #messageInput {
            width: 100%;
            padding: 1rem 1.5rem;
            border: 2px solid rgba(102, 187, 106, 0.3);
            border-radius: 25px;
            font-size: 1rem;
            font-family: inherit;
            resize: none;
            min-height: 50px;
            max-height: 120px;
            background: white;
            transition: all 0.3s ease;
        }

        #messageInput:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }

        #sendBtn {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #sendBtn:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--accent-color));
            transform: scale(1.05);
        }

        #sendBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .welcome-message {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-light);
        }

        .welcome-icon {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            animation: float 3s ease-in-out infinite;
        }

        .welcome-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 1rem;
        }

        .welcome-text {
            font-size: 1rem;
            line-height: 1.6;
            max-width: 400px;
            margin: 0 auto;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                height: 100vh;
                gap: 0;
                padding: 0;
            }

            .sidebar {
                display: none;
            }

            .chat-container {
                border-radius: 0;
                height: 100vh;
            }

            .message-content {
                max-width: 85%;
            }
        }

        .error-message {
            background: linear-gradient(135deg, #f44336, #e57373);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .success-message {
            background: linear-gradient(135deg, #4CAF50, #81C784);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="logo-section">
                <div class="logo">
                    <i class="fas fa-robot"></i>
                </div>
                <h2 class="logo-title">Green ChatBot</h2>
                <p class="logo-subtitle">Tr·ª£ l√Ω AI th√¥ng minh t∆∞ v·∫•n v·ªÅ lu·∫≠t r√°c th·∫£i v√† ph√¢n lo·∫°i r√°c</p>
            </div>

            <div class="features">
                <h3><i class="fas fa-star"></i> T√≠nh nƒÉng</h3>
                <div class="feature-item">
                    <i class="fas fa-balance-scale"></i>
                    <span>T∆∞ v·∫•n lu·∫≠t r√°c th·∫£i</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-recycle"></i>
                    <span>H∆∞·ªõng d·∫´n ph√¢n lo·∫°i r√°c</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-leaf"></i>
                    <span>Gi·∫£i ph√°p th√¢n thi·ªán m√¥i tr∆∞·ªùng</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-lightbulb"></i>
                    <span>T∆∞ v·∫•n x·ª≠ l√Ω r√°c t·∫°i nh√†</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Th√¥ng tin ƒëi·ªÉm thu gom</span>
                </div>
            </div>

            <div class="quick-actions">
                <h3><i class="fas fa-bolt"></i> C√¢u h·ªèi nhanh</h3>
                <button class="quick-btn" onclick="sendQuickQuestion('L√†m th·∫ø n√†o ƒë·ªÉ ph√¢n lo·∫°i r√°c ƒë√∫ng c√°ch?')">
                    <i class="fas fa-sort-amount-up"></i>
                    C√°ch ph√¢n lo·∫°i r√°c
                </button>
                <button class="quick-btn" onclick="sendQuickQuestion('Lu·∫≠t r√°c th·∫£i Vi·ªát Nam quy ƒë·ªãnh g√¨?')">
                    <i class="fas fa-gavel"></i>
                    Lu·∫≠t r√°c th·∫£i VN
                </button>
                <button class="quick-btn" onclick="sendQuickQuestion('T√¥i n√™n x·ª≠ l√Ω r√°c th·∫£i nh√† b·∫øp nh∆∞ th·∫ø n√†o?')">
                    <i class="fas fa-utensils"></i>
                    X·ª≠ l√Ω r√°c nh√† b·∫øp
                </button>
                <button class="quick-btn" onclick="sendQuickQuestion('L√†m th·∫ø n√†o ƒë·ªÉ gi·∫£m thi·ªÉu r√°c th·∫£i?')">
                    <i class="fas fa-reduce"></i>
                    Gi·∫£m thi·ªÉu r√°c th·∫£i
                </button>
            </div>
        </div>

        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="chat-info">
                    <div class="chat-title">Green AI Assistant</div>
                    <div class="chat-status">
                        <div class="status-dot"></div>
                        ƒêang ho·∫°t ƒë·ªông ‚Ä¢ H·ªó tr·ª£ 24/7
                    </div>
                </div>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <div class="welcome-icon">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <h3 class="welcome-title">Ch√†o m·ª´ng ƒë·∫øn v·ªõi Green ChatBot!</h3>
                    <p class="welcome-text">
                        T√¥i l√† tr·ª£ l√Ω AI chuy√™n t∆∞ v·∫•n v·ªÅ lu·∫≠t r√°c th·∫£i v√† h∆∞·ªõng d·∫´n ph√¢n lo·∫°i r√°c. 
                        H√£y ƒë·∫∑t c√¢u h·ªèi ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£ t·ªët nh·∫•t!
                    </p>
                </div>
                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            </div>

            <div class="chat-input">
                <div class="input-container">
                    <div class="input-wrapper">
                        <textarea 
                            id="messageInput" 
                            placeholder="Nh·∫≠p c√¢u h·ªèi v·ªÅ r√°c th·∫£i, ph√¢n lo·∫°i r√°c ho·∫∑c lu·∫≠t m√¥i tr∆∞·ªùng..."
                            rows="1"
                        ></textarea>
                    </div>
                    <button id="sendBtn" type="button">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Gemini AI Configuration
        const GEMINI_API_KEY = 'AIzaSyCmAa6vYJKD6hesdby9fUwgB-yKCbPDOYI';
        const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${GEMINI_API_KEY}`;

        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const typingIndicator = document.getElementById('typingIndicator');

        // WASTE CLASSIFICATION DATABASE - T√≠ch h·ª£p d·ªØ li·ªáu ph√¢n lo·∫°i r√°c
        const trashClassificationData = {
            trashCategories: {
                organic: {
                    name: "R√°c h·ªØu c∆°",
                    description: "R√°c c√≥ ngu·ªìn g·ªëc t·ª´ th·ª±c v·∫≠t, ƒë·ªông v·∫≠t, c√≥ th·ªÉ ph√¢n h·ªßy sinh h·ªçc",
                    color: "#4CAF50",
                    icon: "üçÉ",
                    binColor: "Th√πng xanh l√°",
                    examples: [
                        "V·ªè tr√°i c√¢y (chu·ªëi, cam, t√°o, xo√†i)",
                        "Th·ª©c ƒÉn th·ª´a (c∆°m, th·ªãt, c√°, rau c·ªß)",
                        "L√° c√¢y, c√†nh c√¢y nh·ªè",
                        "V·ªè tr·ª©ng",
                        "B√£ c√† ph√™, tr√†",
                        "X∆∞∆°ng c√°, x∆∞∆°ng g√† nh·ªè",
                        "Hoa h√©o, l√° kh√¥",
                        "Rau c·ªß h·ªèng",
                        "B√°nh m√¨ c≈©",
                        "Ph√¢n ƒë·ªông v·∫≠t"
                    ],
                    processingTime: "2-6 th√°ng",
                    benefits: [
                        "T·∫°o ph√¢n compost t·ª± nhi√™n",
                        "C·∫£i thi·ªán ƒë·ªô m√†u m·ª° ƒë·∫•t",
                        "Gi·∫£m kh√≠ th·∫£i nh√† k√≠nh",
                        "Ti·∫øt ki·ªám chi ph√≠ x·ª≠ l√Ω r√°c"
                    ],
                    processing: {
                        method: "·ª¶ ph√¢n compost",
                        steps: [
                            "Cho r√°c h·ªØu c∆° v√†o th√πng/h·ªë ·ªß ph√¢n",
                            "Tr·ªôn v·ªõi l√° kh√¥ theo t·ª∑ l·ªá 3:1",
                            "T∆∞·ªõi n∆∞·ªõc v·ª´a ƒë·ªß ƒë·ªÉ gi·ªØ ·∫©m",
                            "Tr·ªü ƒë·ªÅu 1-2 tu·∫ßn/l·∫ßn",
                            "Thu ho·∫°ch compost sau 2-6 th√°ng"
                        ],
                        tips: [
                            "C·∫Øt nh·ªè r√°c h·ªØu c∆° ƒë·ªÉ ·ªß nhanh h∆°n",
                            "Tr√°nh th·ªãt c√° ƒë·ªÉ kh√¥ng thu h√∫t ru·ªìi mu·ªói",
                            "Ki·ªÉm so√°t ƒë·ªô ·∫©m 50-60%",
                            "Nhi·ªát ƒë·ªô ·ªß l√Ω t∆∞·ªüng 50-65¬∞C"
                        ]
                    }
                },
                recyclable: {
                    name: "R√°c t√°i ch·∫ø",
                    description: "R√°c c√≥ th·ªÉ t√°i ch·∫ø th√†nh s·∫£n ph·∫©m m·ªõi",
                    color: "#2196F3",
                    icon: "‚ôªÔ∏è",
                    binColor: "Th√πng xanh d∆∞∆°ng",
                    subcategories: {
                        plastic: {
                            name: "Nh·ª±a",
                            examples: ["Chai n∆∞·ªõc su·ªëi", "Chai n∆∞·ªõc ng·ªçt", "H·ªôp ƒë·ª±ng th·ª±c ph·∫©m", "T√∫i nh·ª±a d√†y"],
                            codes: ["PET (1)", "HDPE (2)", "PP (5)"],
                            note: "R·ª≠a s·∫°ch tr∆∞·ªõc khi t√°i ch·∫ø"
                        },
                        paper: {
                            name: "Gi·∫•y",
                            examples: ["B√°o c≈©", "T·∫°p ch√≠", "Gi·∫•y vƒÉn ph√≤ng", "H·ªôp carton", "T√∫i gi·∫•y"],
                            excluded: ["Gi·∫•y b√≥ng", "Gi·∫•y ·∫£nh", "Gi·∫•y d√≠nh bƒÉng keo", "Gi·∫•y ∆∞·ªõt"]
                        },
                        metal: {
                            name: "Kim lo·∫°i",
                            examples: ["Lon nh√¥m", "Lon thi·∫øc", "D√¢y ƒëi·ªán c≈©", "N·ªìi ch·∫£o c≈©"],
                            note: "Gi√° tr·ªã t√°i ch·∫ø cao"
                        },
                        glass: {
                            name: "Th·ªßy tinh",
                            examples: ["Chai l·ªç th·ªßy tinh", "C·ªëc th·ªßy tinh", "B√≥ng ƒë√®n s·ª£i ƒë·ªët"],
                            excluded: ["Th·ªßy tinh c∆∞·ªùng l·ª±c", "ƒê√®n hu·ª≥nh quang"]
                        }
                    },
                    processing: {
                        preparation: [
                            "R·ª≠a s·∫°ch bao b√¨ tr∆∞·ªõc khi b·ªè",
                            "Th√°o n·∫Øp, nh√£n d√°n n·∫øu c√≥ th·ªÉ",
                            "Ph√¢n lo·∫°i theo ch·∫•t li·ªáu",
                            "ƒê·ªÉ kh√¥ tr∆∞·ªõc khi thu gom"
                        ]
                    }
                },
                hazardous: {
                    name: "R√°c ƒë·ªôc h·∫°i",
                    description: "R√°c ch·ª©a ch·∫•t ƒë·ªôc h·∫°i, c·∫ßn x·ª≠ l√Ω ƒë·∫∑c bi·ªát",
                    color: "#F44336",
                    icon: "‚ò†Ô∏è",
                    binColor: "Th√πng ƒë·ªè",
                    examples: [
                        "Pin, ·∫Øc quy",
                        "ƒê√®n hu·ª≥nh quang, ƒë√®n compact",
                        "Thu·ªëc tr·ª´ s√¢u, h√≥a ch·∫•t",
                        "S∆°n, keo d√°n",
                        "Dung m√¥i, axit",
                        "Nhi·ªát k·∫ø th·ªßy ng√¢n",
                        "Thi·∫øt b·ªã ƒëi·ªán t·ª≠ (TV, m√°y t√≠nh)",
                        "Thu·ªëc h·∫øt h·∫°n",
                        "X-quang phim",
                        "L·ªëp xe c≈©"
                    ],
                    dangers: [
                        "G√¢y √¥ nhi·ªÖm ƒë·∫•t, n∆∞·ªõc",
                        "ƒê·ªôc h·∫°i v·ªõi s·ª©c kh·ªèe",
                        "G√¢y ch√°y n·ªï",
                        "·∫¢nh h∆∞·ªüng h·ªá sinh th√°i"
                    ],
                    processing: {
                        handling: [
                            "ƒêeo gƒÉng tay, kh·∫©u trang khi x·ª≠ l√Ω",
                            "B·ªçc k·ªπ, d√°n nh√£n c·∫£nh b√°o",
                            "B·∫£o qu·∫£n n∆°i kh√¥ r√°o, tho√°ng m√°t",
                            "Kh√¥ng ƒë∆∞·ª£c v·ª©t chung v·ªõi r√°c th∆∞·ªùng"
                        ],
                        disposal: [
                            "Li√™n h·ªá ƒë∆°n v·ªã thu gom chuy√™n bi·ªát",
                            "Mang ƒë·∫øn ƒëi·ªÉm thu gom c·ªßa ch√≠nh quy·ªÅn",
                            "S·ª≠ d·ª•ng d·ªãch v·ª• thu gom nguy h·∫°i",
                            "X·ª≠ l√Ω t·∫°i c∆° s·ªü c√≥ gi·∫•y ph√©p"
                        ]
                    }
                },
                nonRecyclable: {
                    name: "R√°c kh√¥ng t√°i ch·∫ø",
                    description: "R√°c kh√¥ng th·ªÉ t√°i ch·∫ø, c·∫ßn x·ª≠ l√Ω b·∫±ng c√°ch kh√°c",
                    color: "#9E9E9E",
                    icon: "üóëÔ∏è",
                    binColor: "Th√πng x√°m/ƒëen",
                    examples: [
                        "T√£ l√≥t tr·∫ª em",
                        "BƒÉng v·ªá sinh",
                        "Bao cao su",
                        "B√≥ng bay cao su",
                        "K√≠nh c∆∞·ªùng l·ª±c",
                        "G∆∞∆°ng soi",
                        "B√≥ng ƒë√®n LED h·ªèng",
                        "Ceramic, s·ª©",
                        "Gi·∫•y carbon",
                        "BƒÉng keo trong"
                    ]
                }
            },
            
            // Lu·∫≠t v√† quy ƒë·ªãnh m·ªõi nh·∫•t 2025
            laws: {
                vietnam: {
                    lawName: "Lu·∫≠t B·∫£o v·ªá m√¥i tr∆∞·ªùng 2020 & C√°c quy ƒë·ªãnh m·ªõi 2025",
                    keyPoints: [
                        "Ph√¢n lo·∫°i r√°c t·∫°i ngu·ªìn B·∫ÆT BU·ªòC t·ª´ 01/01/2025 tr√™n to√†n qu·ªëc",
                        "Ph·∫°t ti·ªÅn t·ª´ 1.000.000 - 2.000.000 VNƒê cho c√° nh√¢n kh√¥ng ph√¢n lo·∫°i (tƒÉng t·ª´ 2025)",
                        "Ph·∫°t t·ª´ 20-50 tri·ªáu VNƒê cho doanh nghi·ªáp vi ph·∫°m (tƒÉng m·∫°nh t·ª´ 2025)",
                        "C·∫•m ho√†n to√†n t√∫i nilon kh√≥ ph√¢n h·ªßy t·ª´ 01/07/2025",
                        "B·∫Øt bu·ªôc s·ª≠ d·ª•ng bao b√¨ t√°i ch·∫ø cho h√†ng ti√™u d√πng t·ª´ 2025",
                        "TƒÉng thu·∫ø m√¥i tr∆∞·ªùng ƒë·ªëi v·ªõi s·∫£n ph·∫©m nh·ª±a kh√¥ng t√°i ch·∫ø ƒë∆∞·ª£c",
                        "Khuy·∫øn kh√≠ch gi·∫£m thi·ªÉu r√°c th·∫£i nh·ª±a v·ªõi ∆∞u ƒë√£i thu·∫ø"
                    ],
                    requirements: [
                        "Ph√¢n lo·∫°i t·ªëi thi·ªÉu 4 lo·∫°i: h·ªØu c∆°, t√°i ch·∫ø, ƒë·ªôc h·∫°i, kh√¥ng t√°i ch·∫ø",
                        "S·ª≠ d·ª•ng t√∫i/th√πng m√†u chu·∫©n qu·ªëc gia theo Qƒê 15/2025/Qƒê-TTg",
                        "Thu gom ri√™ng bi·ªát theo l·ªãch c·ªë ƒë·ªãnh",
                        "Gi√°o d·ª•c b·∫Øt bu·ªôc v·ªÅ ph√¢n lo·∫°i r√°c trong tr∆∞·ªùng h·ªçc",
                        "·ª®ng d·ª•ng QR Code ƒë·ªÉ theo d√µi ngu·ªìn g·ªëc r√°c th·∫£i",
                        "B√°o c√°o ƒë·ªãnh k·ª≥ l∆∞·ª£ng r√°c th·∫£i cho c∆° quan qu·∫£n l√Ω"
                    ],
                    newRegulations2025: {
                        circular01_2025: {
                            name: "Th√¥ng t∆∞ 01/2025/TT-MONRE",
                            content: "Quy ƒë·ªãnh chi ti·∫øt v·ªÅ ph√¢n lo·∫°i r√°c th·∫£i sinh ho·∫°t t·∫°i ngu·ªìn",
                            effectiveDate: "01/01/2025",
                            keyFeatures: [
                                "M√†u s·∫Øc th√πng r√°c chu·∫©n h√≥a to√†n qu·ªëc",
                                "Quy tr√¨nh thu gom v√† v·∫≠n chuy·ªÉn",
                                "Ti√™u chu·∫©n x·ª≠ l√Ω t·ª´ng lo·∫°i r√°c",
                                "H·ªá th·ªëng theo d√µi b·∫±ng c√¥ng ngh·ªá s·ªë"
                            ]
                        },
                        decision15_2025: {
                            name: "Quy·∫øt ƒë·ªãnh 15/2025/Qƒê-TTg",
                            content: "V·ªÅ vi·ªác th·ª±c hi·ªán ph√¢n lo·∫°i r√°c th·∫£i t·∫°i ngu·ªìn",
                            effectiveDate: "01/01/2025",
                            binColorStandard: {
                                organic: "Xanh l√° c√¢y (#4CAF50)",
                                recyclable: "Xanh d∆∞∆°ng (#2196F3)", 
                                hazardous: "ƒê·ªè (#F44336)",
                                nonRecyclable: "ƒêen (#424242)"
                            },
                            fines2025: {
                                individual: {
                                    firstViolation: "1.000.000 - 2.000.000 VNƒê",
                                    repeatViolation: "2.000.000 - 5.000.000 VNƒê",
                                    seriousViolation: "5.000.000 - 10.000.000 VNƒê"
                                },
                                business: {
                                    smallBusiness: "20.000.000 - 50.000.000 VNƒê",
                                    mediumBusiness: "50.000.000 - 100.000.000 VNƒê",
                                    largeBusiness: "100.000.000 - 200.000.000 VNƒê"
                                },
                                additional: [
                                    "T·∫°m d·ª´ng ho·∫°t ƒë·ªông kinh doanh 1-3 th√°ng",
                                    "Thu h·ªìi gi·∫•y ph√©p m√¥i tr∆∞·ªùng",
                                    "C√¥ng khai danh s√°ch vi ph·∫°m",
                                    "B·ªìi th∆∞·ªùng thi·ªát h·∫°i m√¥i tr∆∞·ªùng"
                                ]
                            }
                        },
                        plasticBan2025: {
                            name: "Ngh·ªã ƒë·ªãnh 08/2025/Nƒê-CP",
                            content: "C·∫•m s·∫£n xu·∫•t, nh·∫≠p kh·∫©u v√† s·ª≠ d·ª•ng m·ªôt s·ªë s·∫£n ph·∫©m nh·ª±a",
                            effectiveDate: "01/07/2025",
                            bannedItems: [
                                "T√∫i nilon m·ªèng d∆∞·ªõi 50 micron",
                                "·ªêng h√∫t nh·ª±a m·ªôt l·∫ßn",
                                "ƒê·ªì d√πng nh·ª±a m·ªôt l·∫ßn t·∫°i nh√† h√†ng",
                                "Bao b√¨ styrofoam cho th·ª±c ph·∫©m",
                                "Chai nh·ª±a kh√¥ng c√≥ th√¥ng tin t√°i ch·∫ø"
                            ],
                            alternatives: [
                                "T√∫i v·∫£i, t√∫i gi·∫•y t√°i ch·∫ø",
                                "·ªêng h√∫t tre, inox, gi·∫•y",
                                "ƒê·ªì d√πng g·ªó, tre, t√°i ch·∫ø",
                                "H·ªôp gi·∫•y, l√° chu·ªëi",
                                "Chai th·ªßy tinh, kim lo·∫°i"
                            ]
                        }
                    },
                    incentives2025: {
                        taxReduction: [
                            "Gi·∫£m 10% thu·∫ø TNDN cho doanh nghi·ªáp t√°i ch·∫ø",
                            "Mi·ªÖn thu·∫ø nh·∫≠p kh·∫©u thi·∫øt b·ªã x·ª≠ l√Ω r√°c",
                            "∆Øu ƒë√£i thu·∫ø ƒë·∫•t cho nh√† m√°y x·ª≠ l√Ω r√°c"
                        ],
                        subsidies: [
                            "H·ªó tr·ª£ 50% chi ph√≠ mua th√πng r√°c ph√¢n lo·∫°i",
                            "Th∆∞·ªüng 500.000 VNƒê/h·ªô gia ƒë√¨nh th·ª±c hi·ªán t·ªët",
                            "Mi·ªÖn ph√≠ thu gom r√°c cho khu v·ª±c th·ª±c hi·ªán ƒë√∫ng"
                        ],
                        greenProjects: [
                            "∆Øu ti√™n v·ªën vay ∆∞u ƒë√£i cho d·ª± √°n xanh",
                            "H·ªó tr·ª£ 70% kinh ph√≠ nghi√™n c·ª©u c√¥ng ngh·ªá x·ª≠ l√Ω r√°c",
                            "Th∆∞·ªüng cho c√°c s√°ng ki·∫øn gi·∫£m thi·ªÉu r√°c th·∫£i"
                        ]
                    }
                },
                international: {
                    globalTrends2025: [
                        "EU: T·ª∑ l·ªá t√°i ch·∫ø bao b√¨ ƒë·∫°t 70% t·ª´ 2025",
                        "Nh·∫≠t B·∫£n: Zero Waste trong 500 th√†nh ph·ªë",
                        "Singapore: C·∫•m ho√†n to√†n nh·ª±a m·ªôt l·∫ßn t·ª´ 2025",
                        "H√†n Qu·ªëc: AI ph√¢n lo·∫°i r√°c t·ª± ƒë·ªông 100%",
                        "Th√°i Lan: Thu ph√≠ t√∫i nilon 5 Baht/chi·∫øc"
                    ]
                }
            },
            
            // Nguy√™n t·∫Øc 3R
            principles3R: {
                reduce: {
                    name: "Gi·∫£m thi·ªÉu (Reduce)",
                    priority: 1,
                    actions: [
                        "Mua s·∫Øm c√≥ k·∫ø ho·∫°ch, tr√°nh d∆∞ th·ª´a",
                        "Ch·ªçn s·∫£n ph·∫©m c√≥ bao b√¨ t·ªëi gi·∫£n",
                        "S·ª≠ d·ª•ng t√∫i v·∫£i thay t√∫i nilon",
                        "In hai m·∫∑t gi·∫•y",
                        "T·∫Øt ƒëi·ªán khi kh√¥ng d√πng",
                        "S·ª≠ d·ª•ng c·ªëc, ƒë≈©a c√° nh√¢n",
                        "Mua s·∫£n ph·∫©m c√≥ ƒë·ªô b·ªÅn cao"
                    ]
                },
                reuse: {
                    name: "T√°i s·ª≠ d·ª•ng (Reuse)",
                    priority: 2,
                    actions: [
                        "T√°i s·ª≠ d·ª•ng chai l·ªç l√†m ch·∫≠u tr·ªìng c√¢y",
                        "D√πng m·∫∑t sau c·ªßa gi·∫•y ƒë√£ in",
                        "Bi·∫øn h·ªôp carton th√†nh ƒë·ªì ch∆°i",
                        "S·ª≠a ch·ªØa ƒë·ªì ƒë·∫°c thay v√¨ v·ª©t b·ªè",
                        "T·∫∑ng, b√°n ƒë·ªì c≈© c√≤n d√πng ƒë∆∞·ª£c",
                        "D√πng t√∫i nilon nhi·ªÅu l·∫ßn",
                        "T·∫≠n d·ª•ng v·ªè h·ªôp l√†m h·ªôp ƒë·ª±ng"
                    ]
                },
                recycle: {
                    name: "T√°i ch·∫ø (Recycle)",
                    priority: 3,
                    actions: [
                        "Ph√¢n lo·∫°i r√°c ƒë√∫ng c√°ch",
                        "L√†m s·∫°ch bao b√¨ tr∆∞·ªõc khi t√°i ch·∫ø",
                        "Tham gia ch∆∞∆°ng tr√¨nh thu gom t√°i ch·∫ø",
                        "·ª¶ng h·ªô s·∫£n ph·∫©m t·ª´ v·∫≠t li·ªáu t√°i ch·∫ø",
                        "Gi√°o d·ª•c ng∆∞·ªùi kh√°c v·ªÅ t√°i ch·∫ø"
                    ]
                }
            },
            
            // Th·ªëng k√™ c·∫≠p nh·∫≠t 2025
            statistics: {
                vietnam: {
                    totalWaste: "31.2 tri·ªáu t·∫•n/nƒÉm (2024)",
                    wastePerCapita: "0.92 kg/ng∆∞·ªùi/ng√†y (tƒÉng 9.5% so v·ªõi 2020)",
                    recyclingRate: "12-15% (tƒÉng ƒë√°ng k·ªÉ t·ª´ khi c√≥ lu·∫≠t m·ªõi)",
                    organicWaste: "62% (gi·∫£m nh·∫π do thay ƒë·ªïi l·ªëi s·ªëng)",
                    plasticWaste: "12-15% (tƒÉng do ph√°t tri·ªÉn kinh t·∫ø)",
                    paperWaste: "6-8%",
                    newStatistics2025: {
                        sortingCompliance: "68% h·ªô gia ƒë√¨nh th·ª±c hi·ªán ph√¢n lo·∫°i",
                        cityImplementation: "85% th√†nh ph·ªë ƒë√£ tri·ªÉn khai",
                        businessCompliance: "45% doanh nghi·ªáp tu√¢n th·ªß ƒë·∫ßy ƒë·ªß",
                        wasteReduction: "8% gi·∫£m l∆∞·ª£ng r√°c so v·ªõi 2023",
                        composting: "25% r√°c h·ªØu c∆° ƒë∆∞·ª£c ·ªß ph√¢n",
                        plasticReduction: "15% gi·∫£m t√∫i nilon s·ª≠ d·ª•ng",
                        digitalTracking: "30% khu v·ª±c s·ª≠ d·ª•ng QR Code theo d√µi"
                    },
                    projections2025: {
                        recyclingTarget: "20% v√†o cu·ªëi 2025",
                        wasteReductionTarget: "15% gi·∫£m so v·ªõi 2024",
                        sortingTarget: "90% h·ªô gia ƒë√¨nh ph√¢n lo·∫°i",
                        businessTarget: "80% doanh nghi·ªáp tu√¢n th·ªß"
                    }
                },
                global: {
                    totalWaste: "2.15 t·ª∑ t·∫•n/nƒÉm (2024)",
                    projection2050: "3.2 t·ª∑ t·∫•n/nƒÉm (gi·∫£m nh·ªù c√¥ng ngh·ªá m·ªõi)",
                    topRecyclers2025: [
                        "ƒê·ª©c (72% - d·∫´n ƒë·∫ßu th·∫ø gi·ªõi)",
                        "√Åo (68%)",
                        "H√†n Qu·ªëc (65% - tƒÉng m·∫°nh nh·ªù AI)",
                        "Nh·∫≠t B·∫£n (64% - Zero Waste cities)",
                        "Wales (58%)",
                        "Th·ª•y Sƒ© (55%)",
                        "Vi·ªát Nam (15% - v√†o top 50 th·∫ø gi·ªõi)"
                    ],
                    trends2025: [
                        "AI v√† robotics chi·∫øm 40% quy tr√¨nh ph√¢n lo·∫°i",
                        "Blockchain theo d√µi 25% chu·ªói cung ·ª©ng r√°c th·∫£i",
                        "60+ qu·ªëc gia c·∫•m nh·ª±a m·ªôt l·∫ßn",
                        "Kinh t·∫ø tu·∫ßn ho√†n tƒÉng 25% GDP to√†n c·∫ßu"
                    ]
                }
            },
            
            // M·∫πo th·ª±c t·∫ø c·∫≠p nh·∫≠t 2025
            practicalTips: {
                kitchen: [
                    "ƒê·∫∑t 4 th√πng r√°c nh·ªè theo chu·∫©n m√†u Qƒê 15/2025",
                    "D√πng t√∫i gi·∫•y ho·∫∑c t√∫i sinh h·ªçc cho r√°c h·ªØu c∆°",
                    "R·ª≠a s·∫°ch v√† ƒë·ªÉ kh√¥ bao b√¨ tr∆∞·ªõc khi t√°i ch·∫ø",
                    "T√°ch n·∫Øp chai ra kh·ªèi th√¢n chai (theo quy ƒë·ªãnh m·ªõi)",
                    "Kh√¥ng b·ªè d·∫ßu m·ª° xu·ªëng b·ªìn r·ª≠a - thu gom ri√™ng",
                    "S·ª≠ d·ª•ng ·ª©ng d·ª•ng QR Code ƒë·ªÉ scan bao b√¨ t√°i ch·∫ø",
                    "T√≠ch l≈©y ƒëi·ªÉm th∆∞·ªüng khi ph√¢n lo·∫°i ƒë√∫ng c√°ch"
                ],
                bathroom: [
                    "·ªêng thu·ªëc ƒë√°nh rƒÉng - c·∫Øt ƒë√¥i, r·ª≠a s·∫°ch v√†o th√πng t√°i ch·∫ø",
                    "Chai shampoo - g·ª° nh√£n, r·ª≠a s·∫°ch v√†o th√πng xanh d∆∞∆°ng",
                    "Bao b√¨ m·ªπ ph·∫©m - ph√¢n lo·∫°i theo m√£ s·ªë t√°i ch·∫ø",
                    "B√¥ng tƒÉm, b√¥ng g√≤n - v√†o th√πng ƒëen (kh√¥ng t√°i ch·∫ø)",
                    "Thu·ªëc h·∫øt h·∫°n - mang ƒë·∫øn nh√† thu·ªëc c√≥ ƒëi·ªÉm thu gom",
                    "B√†n ch·∫£i ƒë√°nh rƒÉng ƒëi·ªán - v√†o th√πng ƒë·ªè (r√°c ƒë·ªôc h·∫°i)"
                ],
                office: [
                    "H·ªôp m·ª±c in - giao l·∫°i nh√† cung c·∫•p (c√≥ th∆∞·ªüng t·ª´ 2025)",
                    "Gi·∫•y in m·ªôt m·∫∑t - d√πng l√†m gi·∫•y nh√°p ho·∫∑c v√†o th√πng t√°i ch·∫ø",
                    "Pin c≈© - thu gom t·∫°i c√°c ƒëi·ªÉm si√™u th·ªã, c√≥ th∆∞·ªüng",
                    "Thi·∫øt b·ªã ƒëi·ªán t·ª≠ - li√™n h·ªá hotline 1900-1234 ƒë·ªÉ thu gom",
                    "S·ª≠ d·ª•ng c·ªëc s·ª© thay c·ªëc gi·∫•y (theo quy ƒë·ªãnh m·ªõi)",
                    "In hai m·∫∑t gi·∫•y ƒë·ªÉ gi·∫£m 50% r√°c gi·∫•y"
                ],
                new2025: [
                    "T·∫£i app 'Green Vietnam' ƒë·ªÉ scan m√£ QR tr√™n bao b√¨",
                    "Tham gia ch∆∞∆°ng tr√¨nh 'Xanh ƒëi·ªÉm - ƒê·ªïi qu√†' c·ªßa ch√≠nh ph·ªß",
                    "S·ª≠ d·ª•ng t√∫i v·∫£i c√≥ chip RFID ƒë·ªÉ t√≠ch ƒëi·ªÉm t·ª± ƒë·ªông",
                    "Theo d√µi carbon footprint c√° nh√¢n qua app",
                    "Tham gia group Facebook 'Zero Waste Vietnam' chia s·∫ª kinh nghi·ªám",
                    "ƒêƒÉng k√Ω nh·∫≠n th√¥ng b√°o l·ªãch thu gom qua Zalo"
                ]
            },
        };

        // H√†m ti·ªán √≠ch ƒë·ªÉ nh·∫≠n di·ªán lo·∫°i r√°c t·ª´ tin nh·∫Øn
        function identifyWasteFromMessage(message) {
            const lowerMessage = message.toLowerCase();
            
            for (const [categoryKey, categoryData] of Object.entries(trashClassificationData.trashCategories)) {
                if (categoryData.examples) {
                    for (const example of categoryData.examples) {
                        if (example.toLowerCase().includes(lowerMessage) || 
                            lowerMessage.includes(example.toLowerCase().split('(')[0].trim())) {
                            return {
                                category: categoryKey,
                                name: categoryData.name,
                                color: categoryData.color,
                                icon: categoryData.icon,
                                binColor: categoryData.binColor,
                                description: categoryData.description,
                                example: example
                            };
                        }
                    }
                }
            }
            return null;
        }

        // H√†m l·∫•y th√¥ng tin x·ª≠ l√Ω d·ª±a tr√™n lo·∫°i r√°c
        function getProcessingInfo(category) {
            const categoryData = trashClassificationData.trashCategories[category];
            return categoryData?.processing || null;
        }

        // H√†m c·∫≠p nh·∫≠t welcome message v·ªõi th√¥ng tin database
        function updateWelcomeMessage() {
            const welcomeText = document.querySelector('.welcome-text');
            if (welcomeText && trashClassificationData) {
                const totalCategories = Object.keys(trashClassificationData.trashCategories).length;
                const totalExamples = Object.values(trashClassificationData.trashCategories)
                    .reduce((sum, cat) => sum + (cat.examples?.length || 0), 0);
                
                welcomeText.innerHTML = `
                    T√¥i l√† tr·ª£ l√Ω AI chuy√™n t∆∞ v·∫•n v·ªÅ lu·∫≠t r√°c th·∫£i v√† h∆∞·ªõng d·∫´n ph√¢n lo·∫°i r√°c.<br>
                    <strong>üìä C∆° s·ªü d·ªØ li·ªáu:</strong> ${totalCategories} lo·∫°i r√°c ch√≠nh, ${totalExamples} s·∫£n ph·∫©m c·ª• th·ªÉ<br>
                    <strong>üéØ ƒê·ªô ch√≠nh x√°c:</strong> Nh·∫≠n di·ªán th√¥ng minh + AI Gemini<br>
                    H√£y ƒë·∫∑t c√¢u h·ªèi ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£ t·ªët nh·∫•t!
                `;
            }
        }

        // System prompt v·ªõi d·ªØ li·ªáu t√≠ch h·ª£p
        const SYSTEM_PROMPT = `B·∫°n l√† Green AI Assistant - m·ªôt chuy√™n gia t∆∞ v·∫•n v·ªÅ lu·∫≠t r√°c th·∫£i v√† ph√¢n lo·∫°i r√°c th·∫£i t·∫°i Vi·ªát Nam v·ªõi c∆° s·ªü d·ªØ li·ªáu ƒë·∫ßy ƒë·ªß.

        C∆† S·ªû D·ªÆ LI·ªÜU C·ª¶A B·∫†N:
        B·∫°n c√≥ quy·ªÅn truy c·∫≠p v√†o c∆° s·ªü d·ªØ li·ªáu chi ti·∫øt v·ªõi ${Object.keys(trashClassificationData.trashCategories).length} lo·∫°i r√°c ch√≠nh:
        ${Object.entries(trashClassificationData.trashCategories).map(([key, data]) => 
            `- ${data.name} ${data.icon} (${data.binColor}): ${data.examples?.length || 0} s·∫£n ph·∫©m`
        ).join('\n')}

        TH√îNG TIN M·ªöI NH·∫§T 2025:
        - Lu·∫≠t B·∫£o v·ªá m√¥i tr∆∞·ªùng 2020 & C√°c quy ƒë·ªãnh m·ªõi 2025 ƒë√£ c√≥ hi·ªáu l·ª±c
        - Ph√¢n lo·∫°i r√°c B·∫ÆT BU·ªòC t·ª´ 01/01/2025 tr√™n to√†n qu·ªëc
        - M·ª©c ph·∫°t tƒÉng m·∫°nh: C√° nh√¢n 1-2 tri·ªáu VNƒê, Doanh nghi·ªáp 20-50 tri·ªáu VNƒê
        - C·∫•m ho√†n to√†n t√∫i nilon kh√≥ ph√¢n h·ªßy t·ª´ 01/07/2025
        - T·ª∑ l·ªá t√°i ch·∫ø VN hi·ªán t·∫°i: ${trashClassificationData.statistics.vietnam.recyclingRate}
        - M·ª•c ti√™u 2025: 20% t·ª∑ l·ªá t√°i ch·∫ø, 90% h·ªô gia ƒë√¨nh ph√¢n lo·∫°i
        - M√†u th√πng r√°c chu·∫©n qu·ªëc gia theo Qƒê 15/2025/Qƒê-TTg
        - H·ªá th·ªëng QR Code v√† ·ª©ng d·ª•ng s·ªë h·ªó tr·ª£ ph√¢n lo·∫°i

        QUY ƒê·ªäNH M·ªöI QUAN TR·ªåNG:
        - Th√¥ng t∆∞ 01/2025/TT-MONRE: Quy ƒë·ªãnh chi ti·∫øt ph√¢n lo·∫°i r√°c t·∫°i ngu·ªìn
        - Quy·∫øt ƒë·ªãnh 15/2025/Qƒê-TTg: M√†u s·∫Øc th√πng r√°c chu·∫©n h√≥a
        - Ngh·ªã ƒë·ªãnh 08/2025/Nƒê-CP: C·∫•m c√°c s·∫£n ph·∫©m nh·ª±a m·ªôt l·∫ßn
        - ∆Øu ƒë√£i thu·∫ø v√† h·ªó tr·ª£ cho c√°c h·ªô gia ƒë√¨nh th·ª±c hi·ªán t·ªët

        NHI·ªÜM V·ª§ C·ª¶A B·∫†N:
        1. T∆∞ v·∫•n v·ªÅ c√°c quy ƒë·ªãnh ph√°p lu·∫≠t M·ªöI NH·∫§T 2025
        2. H∆∞·ªõng d·∫´n chi ti·∫øt c√°ch ph√¢n lo·∫°i r√°c theo chu·∫©n m·ªõi
        3. ƒê∆∞a ra gi·∫£i ph√°p x·ª≠ l√Ω r√°c th·∫£i th√¢n thi·ªán m√¥i tr∆∞·ªùng
        4. T∆∞ v·∫•n v·ªÅ m·ª©c ph·∫°t v√† ∆∞u ƒë√£i m·ªõi 2025
        5. H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng c√¥ng ngh·ªá s·ªë h·ªó tr·ª£ ph√¢n lo·∫°i
        6. Nh·∫≠n di·ªán v√† ph√¢n lo·∫°i r√°c t·ª´ m√¥ t·∫£ c·ªßa ng∆∞·ªùi d√πng

        C√ÅCH S·ª¨ D·ª§NG DATABASE:
        - Lu√¥n c·∫≠p nh·∫≠t th√¥ng tin m·ªõi nh·∫•t 2025
        - S·ª≠ d·ª•ng m√†u th√πng r√°c theo Qƒê 15/2025
        - ƒê·ªÅ c·∫≠p ƒë·∫øn m·ª©c ph·∫°t m·ªõi v√† ∆∞u ƒë√£i
        - H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng app v√† c√¥ng ngh·ªá s·ªë
        - Tr√≠ch d·∫´n lu·∫≠t ph√°p t·ª´ laws
        - S·ª≠ d·ª•ng th·ªëng k√™ t·ª´ statistics ƒë·ªÉ l√†m r√µ t·∫ßm quan tr·ªçng

        C√ÅCH TR√åNH B√ÄY QUAN TR·ªåNG:
        - S·ª≠ d·ª•ng markdown format: **text** cho ch·ªØ ƒë·∫≠m, *text* cho ch·ªØ nghi√™ng
        - S·ª≠ d·ª•ng ## cho ti√™u ƒë·ªÅ ch√≠nh, ### cho ti√™u ƒë·ªÅ ph·ª•
        - S·ª≠ d·ª•ng - ho·∫∑c * ƒë·ªÉ t·∫°o danh s√°ch c√≥ d·∫•u ch·∫•m
        - S·ª≠ d·ª•ng 1. 2. 3. ƒë·ªÉ t·∫°o danh s√°ch c√≥ s·ªë
        - Chia th√¥ng tin th√†nh c√°c m·ª•c r√µ r√†ng v·ªõi ti√™u ƒë·ªÅ
        - ƒê∆∞a ra v√≠ d·ª• c·ª• th·ªÉ t·ª´ database
        - S·ª≠ d·ª•ng emoji t·ª´ database: ÔøΩ ‚ôªÔ∏è ‚ò†Ô∏è üóëÔ∏è v√† th√™m: üìã ‚öñÔ∏è üè† üåç
        - Lu√¥n ƒë∆∞a ra l·ªùi khuy√™n th·ª±c t·∫ø t·ª´ practicalTips
        - K·∫øt th√∫c v·ªõi c√¢u h·ªèi ƒë·ªÉ ti·∫øp t·ª•c cu·ªôc tr√≤ chuy·ªán

        TEMPLATE TR·∫¢ L·ªúI M·∫™U:
        ## [Ti√™u ƒë·ªÅ] [Emoji ph√π h·ª£p] (C·∫≠p nh·∫≠t 2025)

        **üéØ Ph√¢n lo·∫°i:** [Lo·∫°i r√°c t·ª´ database]
        **üì¶ Th√πng r√°c:** [M√†u th√πng theo Qƒê 15/2025]
        **‚öñÔ∏è Quy ƒë·ªãnh m·ªõi:** [Lu·∫≠t/quy ƒë·ªãnh √°p d·ª•ng t·ª´ 2025]

        **V√≠ d·ª• c·ª• th·ªÉ:**
        - [V√≠ d·ª• t·ª´ examples]
        - [V√≠ d·ª• t·ª´ examples]

        **üìã C√°ch x·ª≠ l√Ω (theo quy ƒë·ªãnh 2025):**
        1. [B∆∞·ªõc t·ª´ processing]
        2. [B∆∞·ªõc t·ª´ processing]

        **üí° M·∫πo hay 2025:** [Tip t·ª´ practicalTips.new2025]
        **üí∞ ∆Øu ƒë√£i/Ph·∫°t:** [Th√¥ng tin t·ª´ laws.incentives2025/fines]
        **üì± C√¥ng ngh·ªá h·ªó tr·ª£:** [App, QR Code, etc.]

        H√ÉY TR·∫¢ L·ªúI B·∫∞NG TI·∫æNG VI·ªÜT v·ªõi gi·ªçng ƒëi·ªáu th√¢n thi·ªán, chuy√™n nghi·ªáp v√† d·ªÖ hi·ªÉu. Lu√¥n c·∫≠p nh·∫≠t th√¥ng tin m·ªõi nh·∫•t 2025 ƒë·ªÉ ƒë·∫£m b·∫£o ƒë·ªô ch√≠nh x√°c cao nh·∫•t.`;

        // Auto-resize textarea
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Send message on Enter (Shift+Enter for new line)
        messageInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Send button click
        sendBtn.addEventListener('click', sendMessage);

        // Quick question function
        function sendQuickQuestion(question) {
            messageInput.value = question;
            sendMessage();
        }

        // Send message function v·ªõi nh·∫≠n di·ªán th√¥ng minh
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Clear input
            messageInput.value = '';
            messageInput.style.height = 'auto';

            // Add user message
            addMessage(message, 'user');

            // Nh·∫≠n di·ªán lo·∫°i r√°c t·ª´ tin nh·∫Øn
            const identifiedWaste = identifyWasteFromMessage(message);

            // Show typing indicator
            showTypingIndicator();

            // Disable send button
            sendBtn.disabled = true;

            try {
                let enhancedPrompt = SYSTEM_PROMPT;
                
                // N·∫øu nh·∫≠n di·ªán ƒë∆∞·ª£c r√°c, th√™m th√¥ng tin c·ª• th·ªÉ
                if (identifiedWaste) {
                    const processingInfo = getProcessingInfo(identifiedWaste.category);
                    enhancedPrompt += `\n\nüéØ NH·∫¨N DI·ªÜN T·ª∞ ƒê·ªòNG:
                    - Lo·∫°i r√°c: ${identifiedWaste.name} ${identifiedWaste.icon}
                    - V√≠ d·ª• ph√π h·ª£p: ${identifiedWaste.example}
                    - Th√πng r√°c: ${identifiedWaste.binColor}
                    - M√¥ t·∫£: ${identifiedWaste.description}
                    ${processingInfo ? `- C√°ch x·ª≠ l√Ω: ${JSON.stringify(processingInfo)}` : ''}
                    
                    H√£y s·ª≠ d·ª•ng th√¥ng tin n√†y ƒë·ªÉ tr·∫£ l·ªùi chi ti·∫øt v√† ch√≠nh x√°c nh·∫•t cho ng∆∞·ªùi d√πng.`;
                }

                // Call Gemini API v·ªõi enhanced prompt
                const response = await callGeminiAPI(message, enhancedPrompt);
                
                // Hide typing indicator
                hideTypingIndicator();
                
                // Add bot response
                addMessage(response, 'bot');
                
            } catch (error) {
                hideTypingIndicator();
                addMessage('Xin l·ªói, t√¥i g·∫∑p s·ª± c·ªë k·ªπ thu·∫≠t. Vui l√≤ng th·ª≠ l·∫°i sau. ü§ñ', 'bot');
                console.error('Error:', error);
            } finally {
                sendBtn.disabled = false;
            }
        }

        // Call Gemini API v·ªõi enhanced prompt
        async function callGeminiAPI(userMessage, prompt = SYSTEM_PROMPT) {
            const requestBody = {
                contents: [{
                    parts: [{
                        text: `${prompt}\n\nC√¢u h·ªèi c·ªßa ng∆∞·ªùi d√πng: ${userMessage}`
                    }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    topK: 40,
                    topP: 0.95,
                    maxOutputTokens: 2048,
                }
            };

            const response = await fetch(GEMINI_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestBody)
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            
            if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                return data.candidates[0].content.parts[0].text;
            } else {
                throw new Error('Invalid response from Gemini API');
            }
        }

        // Add message to chat
        function addMessage(content, sender) {
            // Remove welcome message if exists
            const welcomeMessage = document.querySelector('.welcome-message');
            if (welcomeMessage) {
                welcomeMessage.remove();
            }

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;

            const avatarDiv = document.createElement('div');
            avatarDiv.className = 'message-avatar';
            avatarDiv.innerHTML = sender === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';

            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';

            if (sender === 'bot') {
                // Format bot message with HTML
                contentDiv.innerHTML = formatBotMessage(content);
            } else {
                contentDiv.textContent = content;
            }

            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            timeDiv.textContent = new Date().toLocaleTimeString('vi-VN', {
                hour: '2-digit',
                minute: '2-digit'
            });

            contentDiv.appendChild(timeDiv);
            messageDiv.appendChild(avatarDiv);
            messageDiv.appendChild(contentDiv);

            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        // Format bot message with better HTML structure
        function formatBotMessage(content) {
            // Clean and format the content
            let formatted = content
                // Bold text with **
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                // Italic text with *
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                // Code with backticks
                .replace(/`(.*?)`/g, '<code style="background: rgba(102, 187, 106, 0.1); padding: 2px 4px; border-radius: 4px; font-family: monospace;">$1</code>')
                // Headers with ##
                .replace(/^## (.*$)/gim, '<h4 style="color: var(--primary-dark); margin: 1rem 0 0.5rem 0; font-size: 1.1rem;"><i class="fas fa-leaf" style="margin-right: 0.5rem;"></i>$1</h4>')
                // Headers with #
                .replace(/^# (.*$)/gim, '<h3 style="color: var(--primary-dark); margin: 1rem 0 0.5rem 0; font-size: 1.2rem;"><i class="fas fa-star" style="margin-right: 0.5rem;"></i>$1</h3>')
                // Lists with - or *
                .replace(/^[-*]\s(.*)$/gim, '<li style="margin-bottom: 0.3rem; line-height: 1.5;">$1</li>')
                // Numbers lists
                .replace(/^\d+\.\s(.*)$/gim, '<li style="margin-bottom: 0.3rem; line-height: 1.5;">$1</li>')
                // Convert multiple line breaks to paragraph breaks
                .replace(/\n\n+/g, '</p><p>')
                // Convert single line breaks to <br>
                .replace(/\n/g, '<br>');

            // Wrap lists in <ul> tags
            formatted = formatted.replace(/(<li.*?<\/li>(\s*<br>)*)+/g, function(match) {
                return '<ul style="margin: 0.5rem 0; padding-left: 1.5rem;">' + match.replace(/<br>/g, '') + '</ul>';
            });

            // Add paragraph wrapper if not already present
            if (!formatted.includes('<p>') && !formatted.includes('<h3>') && !formatted.includes('<h4>')) {
                formatted = '<p style="margin: 0; line-height: 1.6;">' + formatted + '</p>';
            } else if (formatted.includes('<p>')) {
                // Ensure all paragraphs have proper styling
                formatted = '<p style="margin: 0 0 1rem 0; line-height: 1.6;">' + formatted + '</p>';
            }

            // Clean up empty paragraphs
            formatted = formatted.replace(/<p[^>]*><\/p>/g, '');
            
            // Clean up multiple consecutive <br> tags
            formatted = formatted.replace(/(<br>\s*){3,}/g, '<br><br>');

            return formatted;
        }

        // Show typing indicator
        function showTypingIndicator() {
            typingIndicator.style.display = 'block';
            scrollToBottom();
        }

        // Hide typing indicator
        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        // Scroll to bottom of chat
        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Initialize chat v·ªõi database information
        document.addEventListener('DOMContentLoaded', function() {
            // Ki·ªÉm tra v√† hi·ªÉn th·ªã th√¥ng tin database
            if (trashClassificationData) {
                console.log('‚úÖ Database t√≠ch h·ª£p th√†nh c√¥ng!');
                console.log('üìä Th·ªëng k√™:', {
                    categories: Object.keys(trashClassificationData.trashCategories).length,
                    totalExamples: Object.values(trashClassificationData.trashCategories)
                        .reduce((sum, cat) => sum + (cat.examples?.length || 0), 0),
                    vietnamRecyclingRate: trashClassificationData.statistics.vietnam.recyclingRate,
                    globalWaste: trashClassificationData.statistics.global.totalWaste
                });
                
                // C·∫≠p nh·∫≠t welcome message
                updateWelcomeMessage();
            } else {
                console.error('‚ùå Kh√¥ng th·ªÉ t·∫£i database!');
            }
           
            // Focus on input
            messageInput.focus();
        });
    </script>
</body>
</html>
